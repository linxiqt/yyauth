import{r as c,x as y,j as k,c as n,a as e,k as v,y as _,m as g,v as b,G as M,F as z,l as C,d as V,t as a,n as h,o as i}from"./scWRxJKX.js";const j={class:"bg-white shadow-md rounded-lg p-6 mb-6"},B={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},A=["value"],S={class:"flex justify-end"},q=["disabled"],D={key:0,class:"flex items-center"},N={key:1},E={key:0,class:"bg-red-50 border-l-4 border-red-500 p-4 mb-6"},F={class:"flex"},H={class:"ml-3"},I={class:"text-sm text-red-700"},L={key:1,class:"space-y-6"},U={class:"bg-white shadow-lg rounded-xl overflow-hidden"},$={class:"p-6"},P={class:"flex items-center justify-between mb-6"},Q={class:"flex items-center"},T={class:"text-lg font-semibold text-gray-800"},G={class:"text-sm text-gray-500"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},J={class:"space-y-4"},K={class:"flex items-center"},O={class:"text-gray-600"},W={class:"flex items-center"},X={class:"text-gray-600"},Y={class:"flex items-center"},Z={class:"text-gray-600"},ee={class:"space-y-4"},te={class:"flex items-center"},se={class:"text-gray-600"},oe={class:"flex items-center"},re={class:"text-gray-600"},ae={class:"flex items-center"},le={class:"text-gray-600"},ne={key:2,class:"bg-white shadow-md rounded-lg p-8 text-center"},ue={__name:"query",setup(ie){const u=c(!1),d=c(null),o=c(null),p=c(!1),r=y({domain:"",app_id:""}),m=c([]),x=async()=>{try{const s=await fetch("/api/apps",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=await s.json();if(!s.ok)throw new Error(t.message||"获取应用列表失败");m.value=t.data.items||[]}catch(s){console.error("获取应用列表出错:",s),d.value=s.message||"获取应用列表时发生错误，请重试"}};k(()=>{x()});const w=async()=>{if(!r.domain&&!r.app_id){d.value="请至少输入域名或选择应用之一进行查询";return}try{u.value=!0,d.value=null;const s=new URLSearchParams;r.domain&&s.append("domain",r.domain),r.app_id&&s.append("app_id",r.app_id);const t=await fetch(`/api/verify?${s.toString()}`),l=await t.json();if(!t.ok)throw new Error(l.message||"查询失败");o.value=l.data,p.value=!0}catch(s){console.error("查询授权出错:",s),d.value=s.message||"查询过程中发生错误，请重试",o.value=null}finally{u.value=!1}},f=s=>s?new Date(s*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"未设置";return(s,t)=>(i(),n("div",null,[t[17]||(t[17]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"授权查询"),e("p",{class:"text-gray-600 mt-1"},"查询授权状态和详细信息")],-1)),e("div",j,[e("form",{onSubmit:_(w,["prevent"]),class:"space-y-4"},[e("div",B,[e("div",null,[t[2]||(t[2]=e("label",{for:"domain",class:"block text-sm font-medium text-gray-700 mb-1"},"域名",-1)),g(e("input",{type:"text",id:"domain","onUpdate:modelValue":t[0]||(t[0]=l=>r.domain=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"例如: example.com"},null,512),[[b,r.domain]])]),e("div",null,[t[4]||(t[4]=e("label",{for:"app",class:"block text-sm font-medium text-gray-700 mb-1"},"应用",-1)),g(e("select",{id:"app","onUpdate:modelValue":t[1]||(t[1]=l=>r.app_id=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-pink-500 focus:border-pink-500"},[t[3]||(t[3]=e("option",{value:""},"选择应用",-1)),(i(!0),n(z,null,C(m.value,l=>(i(),n("option",{key:l.id,value:l.id},a(l.name),9,A))),128))],512),[[M,r.app_id]])])]),t[6]||(t[6]=e("div",{class:"text-sm text-gray-600"},[e("p",null,"至少填写一项进行查询")],-1)),e("div",S,[e("button",{type:"submit",disabled:u.value||!r.domain&&!r.app_id,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-pink-600 hover:bg-pink-700 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(i(),n("span",D,t[5]||(t[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),V(" 查询中... ")]))):(i(),n("span",N,"查询授权"))],8,q)])],32)]),d.value?(i(),n("div",E,[e("div",F,[t[7]||(t[7]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm0-2a6 6 0 100-12 6 6 0 000 12zm-1-5v-1h2v1h-2zm0-3V7h2v1h-2z","clip-rule":"evenodd"})])],-1)),e("div",H,[e("p",I,a(d.value),1)])])])):v("",!0),o.value?(i(),n("div",L,[t[15]||(t[15]=e("h2",{class:"text-xl font-semibold text-gray-800"},"查询结果",-1)),e("div",U,[e("div",{class:h(["h-2",o.value.expired?"bg-red-500":"bg-green-500"])},null,2),e("div",$,[e("div",P,[e("div",Q,[t[8]||(t[8]=e("div",{class:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center mr-4"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-pink-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})])],-1)),e("div",null,[e("h3",T,a(o.value.auth.domain),1),e("p",G,"授权ID: "+a(o.value.auth.id),1)])]),e("span",{class:h(["px-3 py-1 rounded-full text-sm font-medium",o.value.expired?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},a(o.value.expired?"已过期":"授权有效"),3)]),e("div",R,[e("div",J,[e("div",K,[t[9]||(t[9]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})],-1)),e("span",O,"QQ: "+a(o.value.auth.qq||"未提供"),1)]),e("div",W,[t[10]||(t[10]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)),e("span",X,"IP: "+a(o.value.auth.ip||"未记录"),1)]),e("div",Y,[t[11]||(t[11]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),e("span",Z,"版本: "+a(o.value.auth.version||"未指定"),1)])]),e("div",ee,[e("div",te,[t[12]||(t[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",se,"到期时间: "+a(f(o.value.auth.outtime)),1)]),e("div",oe,[t[13]||(t[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",re,"价格: "+a(o.value.auth.price?`¥${o.value.auth.price}`:"未记录"),1)]),e("div",ae,[t[14]||(t[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",le,"创建时间: "+a(o.value.auth.created_at),1)])])])])])])):p.value&&!u.value&&!d.value?(i(),n("div",ne,t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),e("h3",{class:"text-lg font-medium text-gray-900"},"未找到授权记录",-1),e("p",{class:"mt-2 text-sm text-gray-500"}," 没有找到与您的查询条件匹配的授权。请检查您输入的信息或尝试其他查询条件。 ",-1)]))):v("",!0)]))}};export{ue as default};
