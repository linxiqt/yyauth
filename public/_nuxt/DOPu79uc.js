import{r as i,B as le,x as O,C as de,j as ue,c as n,a as e,k as _,t as r,F as U,l as B,y as J,m as p,d as h,v as g,D as $,E as R,p as ce,o as a,n as F}from"./BSD6ajEG.js";const pe={class:"mb-6"},me={class:"text-2xl font-bold text-gray-800"},ge={key:0,class:"flex justify-center items-center py-12"},fe={key:1,class:"bg-red-50 border-l-4 border-red-500 p-4 mb-6"},xe={class:"flex"},ve={class:"ml-3"},ye={class:"text-sm text-red-700"},be={key:2,class:"bg-white shadow-md rounded-lg overflow-hidden"},he={class:"bg-gray-50 px-4 py-3 border-b flex space-x-4"},we=["onClick"],ke={class:"p-6"},_e={key:0},$e={class:"border rounded-md p-6"},Ce={key:0,class:"flex justify-center py-8"},je={class:"pt-4"},Se=["disabled"],Ae={key:0},Ee={key:1},ze={key:1},Ue={class:"flex justify-between items-center mb-6"},Be={class:"overflow-x-auto"},Ie={class:"min-w-full divide-y divide-gray-200"},Ve={class:"bg-white divide-y divide-gray-200"},Te={key:0},De={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ne={class:"px-6 py-4 whitespace-nowrap"},qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Le={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Me=["onClick"],Oe=["onClick"],Fe={key:2},Je={class:"flex justify-between items-center mb-6"},Re={class:"space-y-4"},Ge={key:0,class:"bg-gray-50 rounded-md p-4 text-center text-gray-500"},He={class:"flex justify-between items-start"},Ke={class:"font-medium text-gray-900"},Qe={class:"mt-1 text-sm text-gray-500"},We={class:"flex space-x-2"},Xe=["onClick"],Ye=["onClick"],Ze={class:"mt-2 text-sm text-gray-700"},et={class:"mt-2"},tt={class:"mt-6 bg-gray-50 rounded-md p-4 border border-gray-200"},st={class:"text-sm text-gray-600"},ot={class:"bg-gray-100 px-2 py-1 rounded"},nt={key:3},at={class:"flex justify-between items-center mb-6"},rt={class:"space-y-4"},it={key:0,class:"bg-gray-50 rounded-md p-4 text-center text-gray-500"},lt={class:"flex justify-between items-start"},dt={class:"font-medium text-gray-900"},ut={class:"mt-1 text-sm text-gray-500"},ct={class:"flex space-x-2"},pt=["onClick"],mt=["onClick"],gt={class:"mt-2 text-sm text-gray-700 whitespace-pre-line"},ft={class:"mt-6 bg-gray-50 rounded-md p-4 border border-gray-200"},xt={class:"text-sm text-gray-600"},vt={class:"bg-gray-100 px-2 py-1 rounded"},yt={key:4},bt={class:"border rounded-md p-6"},ht={key:0,class:"flex justify-center py-8"},wt={class:"flex items-center"},kt={class:"pt-4"},_t=["disabled"],$t={key:0},Ct={key:1},jt={class:"mt-6 bg-gray-50 rounded-md p-4 border border-gray-200"},St={class:"text-sm text-gray-600"},At={class:"bg-gray-100 px-2 py-1 rounded"},Et={key:3,class:"fixed z-10 inset-0 overflow-y-auto"},zt={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ut={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Bt={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},It={class:"sm:flex sm:items-start"},Vt={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Tt={class:"text-lg leading-6 font-medium text-gray-900"},Dt={class:"mt-4 space-y-4"},Pt={class:"flex items-center"},Nt={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},qt=["disabled"],Lt={key:0},Mt={key:1},Ot={key:4,class:"fixed z-10 inset-0 overflow-y-auto"},Ft={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Jt={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Rt={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Gt={class:"sm:flex sm:items-start"},Ht={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Kt={class:"text-lg leading-6 font-medium text-gray-900"},Qt={class:"mt-4 space-y-4"},Wt={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Xt=["disabled"],Yt={key:0},Zt={key:1},ss={__name:"[id]",setup(es){let A=i("");const G=le(),H=ce(),l=G.params.id,I=i(!0),x=i(null),f=i({}),V=i([]),T=i([]),D=i([]),v=i("auth"),K=[{id:"auth",name:"授权管理"},{id:"announcements",name:"公告管理"},{id:"changelogs",name:"更新日志管理"},{id:"updates",name:"更新管理"},{id:"settings",name:"应用设置"}],C=i(!1),j=i(!1),w=i(null),k=i(null),d=O({title:"",content:"",is_active:!0}),m=O({version:"",changes:""}),y=i(!1),c=i({latest_version:"",signature:"",force_update:!1,update_time:"",download_url:""}),P=i(!1),E=i(!1),u=O({name:"",description:"",identifier:"",platform:"android"}),Q=i(!1),z=i(!1),W=async()=>{try{I.value=!0,x.value=null;const t=await(await fetch(`/api/apps/${l}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!t.success)throw new Error(t.message||"获取应用信息失败");f.value=t.data,u.name=f.value.name||"",u.description=f.value.description||"",u.identifier=f.value.identifier||"",u.platform=f.value.platform||"android"}catch(o){console.error("加载应用信息出错:",o),x.value=o.message||"获取应用信息时发生错误，请重试"}finally{I.value=!1}},N=async()=>{try{const t=await(await fetch(`/api/apps/${l}/auth`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!t.success)throw new Error(t.message||"获取授权列表失败");V.value=t.data.items||[]}catch(o){console.error("加载授权列表出错:",o),x.value=o.message||"获取授权列表时发生错误，请重试"}},q=async()=>{try{const t=await(await fetch(`/api/apps/${l}/announcements`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!t.success)throw new Error(t.message||"获取公告列表失败");T.value=t.data.items||[]}catch(o){console.error("加载公告列表出错:",o),x.value=o.message||"获取公告列表时发生错误，请重试"}},L=async()=>{try{const t=await(await fetch(`/api/apps/${l}/changelogs`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!t.success)throw new Error(t.message||"获取更新日志列表失败");D.value=t.data.items||[]}catch(o){console.error("加载更新日志列表出错:",o),x.value=o.message||"获取更新日志列表时发生错误，请重试"}},X=async()=>{try{P.value=!0;const t=await(await fetch(`/api/apps/${l}/updates`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!t.success)throw new Error(t.message||"获取更新配置失败");if(c.value=t.data||{latest_version:"",signature:"",force_update:!1,update_time:"",download_url:""},c.value.update_time){const s=new Date(c.value.update_time);c.value.update_time=s.toISOString().slice(0,16)}}catch(o){console.error("加载更新配置出错:",o),x.value=o.message||"获取更新配置时发生错误，请重试"}finally{P.value=!1}},Y=async()=>{try{E.value=!0;const t=await(await fetch(`/api/apps/${l}/updates`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(c.value)})).json();if(!t.success)throw new Error(t.message||"保存更新配置失败");alert("更新配置保存成功")}catch(o){console.error("保存更新配置出错:",o),alert(o.message||"保存更新配置时发生错误，请重试")}finally{E.value=!1}},Z=async o=>{if(confirm("确定要删除这条授权记录吗？删除后无法恢复。"))try{const s=await(await fetch(`/api/apps/${l}/auth/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!s.success)throw new Error(s.message||"删除授权失败");N()}catch(t){console.error("删除授权出错:",t),alert(t.message||"删除授权时发生错误，请重试")}},ee=o=>{H.push(`/auth/edit/${o.id}`)},te=o=>{w.value=o,d.title=o.title,d.content=o.content,d.is_active=o.is_active,C.value=!0},se=async()=>{if(!d.title.trim()){alert("请输入公告标题");return}try{y.value=!0;const o=w.value!==null,t=o?`/api/apps/${l}/announcements/${w.value.id}`:`/api/apps/${l}/announcements`,S=await(await fetch(t,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({title:d.title,content:d.content,is_active:d.is_active})})).json();if(!S.success)throw new Error(S.message||(o?"更新公告失败":"创建公告失败"));C.value=!1,w.value=null,d.title="",d.content="",d.is_active=!0,q()}catch(o){console.error("提交公告表单出错:",o),alert(o.message||"处理公告时发生错误，请重试")}finally{y.value=!1}},oe=async o=>{if(confirm("确定要删除这条公告吗？删除后无法恢复。"))try{const s=await(await fetch(`/api/apps/${l}/announcements/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!s.success)throw new Error(s.message||"删除公告失败");q()}catch(t){console.error("删除公告出错:",t),alert(t.message||"删除公告时发生错误，请重试")}},ne=o=>{k.value=o,m.version=o.version,m.changes=o.changes,j.value=!0},ae=async()=>{if(!m.version.trim()){alert("请输入版本号");return}try{y.value=!0;const o=k.value!==null,t=o?`/api/apps/${l}/changelogs/${k.value.id}`:`/api/apps/${l}/changelogs`,S=await(await fetch(t,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({version:m.version,changes:m.changes})})).json();if(!S.success)throw new Error(S.message||(o?"更新日志失败":"创建更新日志失败"));j.value=!1,k.value=null,m.version="",m.changes="",L()}catch(o){console.error("提交更新日志表单出错:",o),alert(o.message||"处理更新日志时发生错误，请重试")}finally{y.value=!1}},re=async o=>{if(confirm("确定要删除这条更新日志吗？删除后无法恢复。"))try{const s=await(await fetch(`/api/apps/${l}/changelogs/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(!s.success)throw new Error(s.message||"删除更新日志失败");L()}catch(t){console.error("删除更新日志出错:",t),alert(t.message||"删除更新日志时发生错误，请重试")}},ie=async()=>{try{z.value=!0;const t=await(await fetch(`/api/apps/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:u.name,description:u.description,identifier:u.identifier,platform:u.platform})})).json();if(!t.success)throw new Error(t.message||"保存应用设置失败");f.value={...f.value,name:u.name,description:u.description,identifier:u.identifier,platform:u.platform},alert("应用设置保存成功")}catch(o){console.error("保存应用设置出错:",o),alert(o.message||"保存应用设置时发生错误，请重试")}finally{z.value=!1}},M=o=>new Date(typeof o=="string"?o:o*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return de(v,o=>{o==="settings"||(o==="auth"?N():o==="announcements"?q():o==="changelogs"?L():o==="updates"&&X())}),ue(()=>{W(),N(),A.value=window.location.host}),(o,t)=>(a(),n("div",null,[e("div",pe,[e("h1",me,r(f.value.name),1),t[17]||(t[17]=e("p",{class:"text-gray-600 mt-1"},"应用管理面板、快速应用敏捷开发",-1))]),I.value?(a(),n("div",ge,t[18]||(t[18]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"},null,-1)]))):x.value?(a(),n("div",fe,[e("div",xe,[t[19]||(t[19]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm0-2a6 6 0 100-12 6 6 0 000 12zm-1-5v-1h2v1h-2zm0-3V7h2v1h-2z","clip-rule":"evenodd"})])],-1)),e("div",ve,[e("p",ye,r(x.value),1)])])])):(a(),n("div",be,[e("div",he,[(a(),n(U,null,B(K,s=>e("button",{key:s.id,onClick:b=>v.value=s.id,class:F(["px-3 py-2 rounded-md text-sm font-medium",[v.value===s.id?"bg-pink-100 text-pink-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"]])},r(s.name),11,we)),64))]),e("div",ke,[v.value==="settings"?(a(),n("div",_e,[t[23]||(t[23]=e("div",{class:"flex justify-between items-center mb-6"},[e("h2",{class:"text-lg font-semibold text-gray-800"},"应用设置")],-1)),e("div",$e,[Q.value?(a(),n("div",Ce,t[20]||(t[20]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-500"},null,-1)]))):(a(),n("form",{key:1,onSubmit:J(ie,["prevent"]),class:"space-y-4"},[e("div",null,[t[21]||(t[21]=e("label",{for:"app_name",class:"block text-sm font-medium text-gray-700"},[h("应用名称 "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{type:"text",id:"app_name","onUpdate:modelValue":t[0]||(t[0]=s=>u.name=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"应用名称",required:""},null,512),[[g,u.name]])]),e("div",null,[t[22]||(t[22]=e("label",{for:"app_description",class:"block text-sm font-medium text-gray-700"},"应用描述",-1)),p(e("textarea",{id:"app_description","onUpdate:modelValue":t[1]||(t[1]=s=>u.description=s),rows:"3",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"应用简介（可选）"},null,512),[[g,u.description]])]),e("div",je,[e("button",{type:"submit",disabled:z.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-pink-600 hover:bg-pink-700 focus:outline-none disabled:opacity-50"},[z.value?(a(),n("span",Ae,"保存中...")):(a(),n("span",Ee,"保存设置"))],8,Se)])],32))])])):v.value==="auth"?(a(),n("div",ze,[e("div",Ue,[t[24]||(t[24]=e("h2",{class:"text-lg font-semibold text-gray-800"},"授权管理",-1)),e("button",{onClick:t[2]||(t[2]=s=>o.$router.push("/auth/create?app="+f.value.id)),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-pink-600 hover:bg-pink-700 focus:outline-none"}," 添加授权 ")]),e("div",Be,[e("table",Ie,[t[26]||(t[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"域名"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"到期时间"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"状态"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"联系方式"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"操作")])],-1)),e("tbody",Ve,[V.value.length===0?(a(),n("tr",Te,t[25]||(t[25]=[e("td",{colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500"},"暂无授权记录",-1)]))):_("",!0),(a(!0),n(U,null,B(V.value,s=>(a(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",De,r(s.domain),1),e("td",Pe,r(M(s.outtime)),1),e("td",Ne,[e("span",{class:F(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.outtime*1e3>Date.now()?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},r(s.outtime*1e3>Date.now()?"正常":"已过期"),3)]),e("td",qe,r(s.qq||"-"),1),e("td",Le,[e("button",{onClick:b=>ee(s),class:"text-pink-600 hover:text-pink-900 mr-2"},"编辑",8,Me),e("button",{onClick:b=>Z(s.id),class:"text-red-600 hover:text-red-900"},"删除",8,Oe)])]))),128))])])])])):v.value==="announcements"?(a(),n("div",Fe,[e("div",Je,[t[27]||(t[27]=e("h2",{class:"text-lg font-semibold text-gray-800"},"公告管理",-1)),e("button",{onClick:t[3]||(t[3]=s=>{C.value=!0,w.value=null}),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-pink-600 hover:bg-pink-700 focus:outline-none"}," 添加公告 ")]),e("div",Re,[T.value.length===0?(a(),n("div",Ge," 暂无公告记录 ")):_("",!0),(a(!0),n(U,null,B(T.value,s=>(a(),n("div",{key:s.id,class:"border rounded-md p-4 hover:bg-gray-50"},[e("div",He,[e("div",null,[e("h3",Ke,r(s.title),1),e("p",Qe,r(M(s.created_at)),1)]),e("div",We,[e("button",{onClick:b=>te(s),class:"text-pink-600 hover:text-pink-900"},"编辑",8,Xe),e("button",{onClick:b=>oe(s.id),class:"text-red-600 hover:text-red-900"},"删除",8,Ye)])]),e("div",Ze,r(s.content),1),e("div",et,[e("span",{class:F(["px-2 py-1 text-xs rounded-full",s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},r(s.is_active?"已发布":"草稿"),3)])]))),128))]),e("div",tt,[t[31]||(t[31]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"接口信息",-1)),e("div",st,[e("p",null,[t[28]||(t[28]=h("应用公告API: ")),e("code",ot,r($(A))+"/api/apps/"+r($(l))+"/announcements",1)]),t[29]||(t[29]=e("p",{class:"mt-2"},"返回格式:",-1)),t[30]||(t[30]=e("pre",{class:"bg-gray-100 p-2 rounded mt-1 overflow-x-auto"},`{
  "success": true,
  "data": {
    "items": [
      {
        "id": "xxxxxxxx",
        "title": "重要公告",
        "content": "这是一条公告内容",
        "is_active": true,
        "created_at": "2023-01-01T00:00:00"
      }
    ]
  }
}`,-1))])])])):v.value==="changelogs"?(a(),n("div",nt,[e("div",at,[t[32]||(t[32]=e("h2",{class:"text-lg font-semibold text-gray-800"},"更新日志管理",-1)),e("button",{onClick:t[4]||(t[4]=s=>{j.value=!0,k.value=null}),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-pink-600 hover:bg-pink-700 focus:outline-none"}," 添加更新日志 ")]),e("div",rt,[D.value.length===0?(a(),n("div",it," 暂无更新日志记录 ")):_("",!0),(a(!0),n(U,null,B(D.value,s=>(a(),n("div",{key:s.id,class:"border rounded-md p-4 hover:bg-gray-50"},[e("div",lt,[e("div",null,[e("h3",dt,r(s.version),1),e("p",ut,r(M(s.created_at)),1)]),e("div",ct,[e("button",{onClick:b=>ne(s),class:"text-pink-600 hover:text-pink-900"},"编辑",8,pt),e("button",{onClick:b=>re(s.id),class:"text-red-600 hover:text-red-900"},"删除",8,mt)])]),e("div",gt,r(s.changes),1)]))),128))]),e("div",ft,[t[36]||(t[36]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"接口信息",-1)),e("div",xt,[e("p",null,[t[33]||(t[33]=h("应用更新日志API: ")),e("code",vt,r($(A))+"/api/apps/"+r($(l))+"/changelogs",1)]),t[34]||(t[34]=e("p",{class:"mt-2"},"返回格式:",-1)),t[35]||(t[35]=e("pre",{class:"bg-gray-100 p-2 rounded mt-1 overflow-x-auto"},`{
  "success": true,
  "data": {
    "items": [
      {
        "id": "xxxxxxxx",
        "version": "1.0.1",
        "changes": "1. 修复了某某问题\\n2. 优化了性能\\n3. 添加了新功能",
        "created_at": "2023-01-01T00:00:00"
      }
    ]
  }
}`,-1))])])])):v.value==="updates"?(a(),n("div",yt,[t[47]||(t[47]=e("div",{class:"flex justify-between items-center mb-6"},[e("h2",{class:"text-lg font-semibold text-gray-800"},"更新管理")],-1)),e("div",bt,[P.value?(a(),n("div",ht,t[37]||(t[37]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-500"},null,-1)]))):(a(),n("form",{key:1,onSubmit:J(Y,["prevent"]),class:"space-y-4"},[e("div",null,[t[38]||(t[38]=e("label",{for:"latest_version",class:"block text-sm font-medium text-gray-700"},[h("最新版本 "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{type:"text",id:"latest_version","onUpdate:modelValue":t[5]||(t[5]=s=>c.value.latest_version=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"例如: 1.0.0",required:""},null,512),[[g,c.value.latest_version]])]),e("div",null,[t[39]||(t[39]=e("label",{for:"signature",class:"block text-sm font-medium text-gray-700"},"签名",-1)),p(e("input",{type:"text",id:"signature","onUpdate:modelValue":t[6]||(t[6]=s=>c.value.signature=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"安装包签名（可选）"},null,512),[[g,c.value.signature]])]),e("div",null,[t[40]||(t[40]=e("label",{for:"download_url",class:"block text-sm font-medium text-gray-700"},[h("更新链接 "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{type:"url",id:"download_url","onUpdate:modelValue":t[7]||(t[7]=s=>c.value.download_url=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"下载地址",required:""},null,512),[[g,c.value.download_url]])]),e("div",wt,[p(e("input",{type:"checkbox",id:"force_update","onUpdate:modelValue":t[8]||(t[8]=s=>c.value.force_update=s),class:"h-4 w-4 text-pink-600 focus:ring-pink-500 border-gray-300 rounded"},null,512),[[R,c.value.force_update]]),t[41]||(t[41]=e("label",{for:"force_update",class:"ml-2 block text-sm text-gray-900"}," 强制更新 ",-1))]),e("div",null,[t[42]||(t[42]=e("label",{for:"update_time",class:"block text-sm font-medium text-gray-700"},"更新时间",-1)),p(e("input",{type:"datetime-local",id:"update_time","onUpdate:modelValue":t[9]||(t[9]=s=>c.value.update_time=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500"},null,512),[[g,c.value.update_time]])]),e("div",kt,[e("button",{type:"submit",disabled:E.value,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-pink-600 hover:bg-pink-700 focus:outline-none disabled:opacity-50"},[E.value?(a(),n("span",$t,"保存中...")):(a(),n("span",Ct,"保存配置"))],8,_t)])],32))]),e("div",jt,[t[46]||(t[46]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"接口信息",-1)),e("div",St,[e("p",null,[t[43]||(t[43]=h("应用更新检查API: ")),e("code",At,r($(A))+"/api/apps/"+r($(l))+"/updates",1)]),t[44]||(t[44]=e("p",{class:"mt-2"},"返回格式:",-1)),t[45]||(t[45]=e("pre",{class:"bg-gray-100 p-2 rounded mt-1 overflow-x-auto"},`{
  "success": true,
  "data": {
    "latest_version": "1.0.0",
    "signature": "xxxx",
    "force_update": false,
    "update_time": "2023-01-01T00:00:00",
    "download_url": "https://example.com/app.apk"
  }
}`,-1))])])])):_("",!0)])])),C.value?(a(),n("div",Et,[e("div",zt,[t[51]||(t[51]=e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[52]||(t[52]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Ut,[e("div",Bt,[e("div",It,[e("div",Vt,[e("h3",Tt,r(w.value?"编辑公告":"添加公告"),1),e("div",Dt,[e("div",null,[t[48]||(t[48]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700"},[h("标题 "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{type:"text",id:"title","onUpdate:modelValue":t[10]||(t[10]=s=>d.title=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"输入公告标题",required:""},null,512),[[g,d.title]])]),e("div",null,[t[49]||(t[49]=e("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"内容",-1)),p(e("textarea",{id:"content","onUpdate:modelValue":t[11]||(t[11]=s=>d.content=s),rows:"5",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"输入公告内容"},null,512),[[g,d.content]])]),e("div",Pt,[p(e("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":t[12]||(t[12]=s=>d.is_active=s),class:"h-4 w-4 text-pink-600 focus:ring-pink-500 border-gray-300 rounded"},null,512),[[R,d.is_active]]),t[50]||(t[50]=e("label",{for:"is_active",class:"ml-2 block text-sm text-gray-900"}," 立即发布 ",-1))])])])])]),e("div",Nt,[e("button",{type:"button",onClick:se,disabled:y.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-pink-600 text-base font-medium text-white hover:bg-pink-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},[y.value?(a(),n("span",Lt,"保存中...")):(a(),n("span",Mt,"保存"))],8,qt),e("button",{type:"button",onClick:t[13]||(t[13]=s=>{C.value=!1,w.value=null}),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," 取消 ")])])])])):_("",!0),j.value?(a(),n("div",Ot,[e("div",Ft,[t[55]||(t[55]=e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[56]||(t[56]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Jt,[e("div",Rt,[e("div",Gt,[e("div",Ht,[e("h3",Kt,r(k.value?"编辑更新日志":"添加更新日志"),1),e("div",Qt,[e("div",null,[t[53]||(t[53]=e("label",{for:"version",class:"block text-sm font-medium text-gray-700"},[h("版本号 "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{type:"text",id:"version","onUpdate:modelValue":t[14]||(t[14]=s=>m.version=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"例如: v1.0.0",required:""},null,512),[[g,m.version]])]),e("div",null,[t[54]||(t[54]=e("label",{for:"changes",class:"block text-sm font-medium text-gray-700"},"更新内容",-1)),p(e("textarea",{id:"changes","onUpdate:modelValue":t[15]||(t[15]=s=>m.changes=s),rows:"5",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500",placeholder:"输入更新内容，可使用换行分隔多项更新"},null,512),[[g,m.changes]])])])])])]),e("div",Wt,[e("button",{type:"button",onClick:ae,disabled:y.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-pink-600 text-base font-medium text-white hover:bg-pink-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},[y.value?(a(),n("span",Yt,"保存中...")):(a(),n("span",Zt,"保存"))],8,Xt),e("button",{type:"button",onClick:t[16]||(t[16]=s=>{j.value=!1,k.value=null}),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," 取消 ")])])])])):_("",!0)]))}};export{ss as default};
